repos:
  # Python code style & format
  - repo: https://github.com/psf/black
    rev: 25.9.0
    hooks:
      - id: black
  
  - repo: https://github.com/PyCQA/flake8
    rev: 7.3.0
    hooks:
      - id: flake8

  - repo: https://github.com/pycqa/isort
    rev: 5.13.2
    hooks:
      - id: isort

  - repo: local
    hooks:
      - id: sphinx-apidoc
        name: "Build sphinx apidoc"
        language: system
        entry: |
          bash -c '
            cd backend
            sphinx-apidoc -f -o docs/ . || exit 1
            git diff --quiet docs/*.rst
            if [ $? -eq 0 ]; then
              echo "✅ Documentation (.rst) is up to date."
              exit 0
            else
              echo "❌ Generated .rst files have changed. Please:"
              echo "    1. Review the changes:"
              echo "       git diff $API_DIR/*.rst"
              echo "    2. Add them to the commit:"
              echo "       git add $API_DIR/*.rst"
              echo "    3. Then retry the commit."
              exit 1
            fi
          '
        types: [python]

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.8.0
    hooks:
      - id: mypy
        additional_dependencies: [types-PyYAML]
